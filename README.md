import base64
exec(base64.b64decode(b'aW1wb3J0IHRraW50ZXIgYXMgdGsKZnJvbSBQSUwgaW1wb3J0IEltYWdlLCBJbWFnZVRrCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHRpbWUKaW1wb3J0IHJhbmRvbQppbXBvcnQgcmVxdWVzdHMKZnJvbSBpbyBpbXBvcnQgQnl0ZXNJTwoKY2xhc3MgVGFpWGl1QXBwOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG1hc3Rlcik6CiAgICAgICAgc2VsZi5tYXN0ZXIgPSBtYXN0ZXIKICAgICAgICBtYXN0ZXIudGl0bGUoIlRvb2wgVMOgaSBY4buJdSIpCgogICAgICAgICMgxJDhurd0IG3DoHUgbuG7gW4gY+G7p2EgY+G7rWEgc+G7lQogICAgICAgIG1hc3Rlci5jb25maWd1cmUoYmc9IiNjZDZhNWEiKQoKICAgICAgICAjIMSQ4bq3dCBrw61jaCB0aMaw4bubYyBj4butYSBz4buVCiAgICAgICAgbWFzdGVyLmdlb21ldHJ5KCI0MDB4MjAwIikKCiAgICAgICAgIyBU4bqhbyBraHVuZyBjaOG7qWEgaMOsbmgg4bqjbmggdsOgIHRpw6p1IMSR4buBCiAgICAgICAgc2VsZi5pbWFnZV9mcmFtZSA9IHRrLkZyYW1lKG1hc3RlciwgYmc9IiNjZDZhNWEiKQogICAgICAgIHNlbGYuaW1hZ2VfZnJhbWUucGFjaygpCgogICAgICAgICMgVOG6oW8gTGFiZWwgY2hvIGjDrG5oIOG6o25oCiAgICAgICAgc2VsZi5pbWFnZV9sYWJlbCA9IHRrLkxhYmVsKHNlbGYuaW1hZ2VfZnJhbWUsIGJnPSIjY2Q2YTVhIikKICAgICAgICBzZWxmLmltYWdlX2xhYmVsLnBhY2soKQoKICAgICAgICAjIExvYWQgaMOsbmgg4bqjbmggdOG7qyBVUkwKICAgICAgICBzZWxmLmxvYWRfaW1hZ2VfZnJvbV91cmwoImh0dHBzOi8vZW5jcnlwdGVkLXRibjAuZ3N0YXRpYy5jb20vaW1hZ2VzP3E9dGJuOkFOZDlHY1IwR0NrSGxJVE9Cc0ZWYVQ0bzBSbWltZFB4RUl3bW9neHF2ZyZzIiwgc2VsZi5pbWFnZV9sYWJlbCkKCiAgICAgICAgIyBU4bqhbyBMYWJlbCBjaG8gdGnDqnUgxJHhu4EKICAgICAgICBzZWxmLnRpdGxlX2xhYmVsID0gdGsuTGFiZWwobWFzdGVyLCB0ZXh0PSJTdW5XaW4iLCBiZz0iI2NkNmE1YSIsIGZnPSJ3aGl0ZSIsIGZvbnQ9KCJUaW1lcyBOZXcgUm9tYW4iLCAxNiwgImJvbGQiKSkKICAgICAgICBzZWxmLnRpdGxlX2xhYmVsLnBhY2soKQoKICAgICAgICBzZWxmLmxhYmVsID0gdGsuTGFiZWwobWFzdGVyLCB0ZXh0PSJOaOG6rXAgc+G7kSBwaGnDqm46IiwgYmc9IiNjZDZhNWEiLCBmZz0id2hpdGUiLCBmb250PSgiVGltZXMgTmV3IFJvbWFuIiwgMTIpKQogICAgICAgIHNlbGYubGFiZWwucGFjaygpCgogICAgICAgIHNlbGYuZW50cnkgPSB0ay5FbnRyeShtYXN0ZXIpCiAgICAgICAgc2VsZi5lbnRyeS5wYWNrKCkKCiAgICAgICAgc2VsZi5wcmVkaWN0X2J1dHRvbiA9IHRrLkJ1dHRvbihtYXN0ZXIsIHRleHQ9IkThu7EgxJFvw6FuIiwgY29tbWFuZD1zZWxmLnByZWRpY3QsIGJnPSIjY2Q2YTVhIiwgZmc9IndoaXRlIiwgZm9udD0oIlRpbWVzIE5ldyBSb21hbiIsIDEyKSkKICAgICAgICBzZWxmLnByZWRpY3RfYnV0dG9uLnBhY2soKQoKICAgICAgICBzZWxmLnJlc3VsdF9sYWJlbCA9IHRrLkxhYmVsKG1hc3RlciwgdGV4dD0iIiwgYmc9IiNjZDZhNWEiLCBmZz0id2hpdGUiLCBmb250PSgiVGltZXMgTmV3IFJvbWFuIiwgMTIpKQogICAgICAgIHNlbGYucmVzdWx0X2xhYmVsLnBhY2soKQoKICAgICAgICBzZWxmLnhpdV9jYW52YXMgPSB0ay5DYW52YXMobWFzdGVyLCB3aWR0aD01MCwgaGVpZ2h0PTUwLCBiZz0iI2NkNmE1YSIsIGhpZ2hsaWdodHRoaWNrbmVzcz0wKQogICAgICAgIHNlbGYueGl1X2NhbnZhcy5wbGFjZSh4PTMwMCwgeT0xMDApCiAgICAgICAgc2VsZi54aXVfY2FudmFzLmNyZWF0ZV9vdmFsKDUsIDUsIDQ1LCA0NSwgZmlsbD0iI2NkNmE1YSIsIHRhZ3M9InhpdV9saWdodCIpCgogICAgICAgICMgTGFiZWwgY2hvIGNo4buvICJY4buJdSIKICAgICAgICBzZWxmLnhpdV9sYWJlbCA9IHRrLkxhYmVsKG1hc3RlciwgdGV4dD0iWOG7iXUiLCBmZz0iYmxhY2siLCBiZz0iI2NkNmE1YSIsIGZvbnQ9KCJUaW1lcyBOZXcgUm9tYW4iLCAyNSwgImJvbGQiKSkKICAgICAgICBzZWxmLnhpdV9sYWJlbC5wbGFjZSh4PTI5NSwgeT00NSkgICMgxJDhurd0IGNo4buvICJY4buJdSIg4bufIHRyw6puIGjDrG5oIHRyw7JuCgogICAgICAgIHNlbGYudGFpX2NhbnZhcyA9IHRrLkNhbnZhcyhtYXN0ZXIsIHdpZHRoPTUwLCBoZWlnaHQ9NTAsIGJnPSIjY2Q2YTVhIiwgaGlnaGxpZ2h0dGhpY2tuZXNzPTApCiAgICAgICAgc2VsZi50YWlfY2FudmFzLnBsYWNlKHg9NTAsIHk9MTAwKQogICAgICAgIHNlbGYudGFpX2NhbnZhcy5jcmVhdGVfb3ZhbCg1LCA1LCA0NSwgNDUsIGZpbGw9IiNjZDZhNWEiLCB0YWdzPSJ0YWlfbGlnaHQiKQoKICAgICAgICAjIExhYmVsIGNobyBjaOG7ryAiVMOgaSIKICAgICAgICBzZWxmLnRhaV9sYWJlbCA9IHRrLkxhYmVsKG1hc3RlciwgdGV4dD0iVMOgaSIsIGZnPSJibGFjayIsIGJnPSIjY2Q2YTVhIiwgZm9udD0oIlRpbWVzIE5ldyBSb21hbiIsIDI1LCAiYm9sZCIpKQogICAgICAgIHNlbGYudGFpX2xhYmVsLnBsYWNlKHg9NDgsIHk9NDUpICAjIMSQ4bq3dCBjaOG7ryAiVMOgaSIg4bufIHRyw6puIGjDrG5oIHRyw7JuCgogICAgICAgIHNlbGYuYmxpbmtpbmcgPSBGYWxzZQogICAgICAgIHNlbGYuYmxpbmtfdGhyZWFkID0gTm9uZQoKICAgIGRlZiBwcmVkaWN0KHNlbGYpOgogICAgICAgIHNlc3Npb25fbnVtYmVycyA9IHNlbGYuZW50cnkuZ2V0KCkuc3RyaXAoKQoKICAgICAgICBpZiBub3Qgc2Vzc2lvbl9udW1iZXJzOgogICAgICAgICAgICBzZWxmLnJlc3VsdF9sYWJlbC5jb25maWcodGV4dD0iVnVpIGzDsm5nIG5o4bqtcCBz4buRIHBoacOqbi4iKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2Vzc2lvbl9udW1iZXJzID0gW2ludChudW0pIGZvciBudW0gaW4gc2Vzc2lvbl9udW1iZXJzLnNwbGl0KCldCgogICAgICAgIHNlbGYucmVzdWx0X2xhYmVsLmNvbmZpZyh0ZXh0PSLEkGFuZyBwaMOibiB0w61jaC4uLiIpCiAgICAgICAgc2VsZi5tYXN0ZXIuYWZ0ZXIoNTAwMCwgbGFtYmRhOiBzZWxmLndhaXRfYW5kX3ByZWRpY3Qoc2Vzc2lvbl9udW1iZXJzKSkKCiAgICBkZWYgd2FpdF9hbmRfcHJlZGljdChzZWxmLCBzZXNzaW9uX251bWJlcnMpOgogICAgICAgIHJlc3VsdCA9IHNlbGYucHJlZGljdF9vdXRjb21lKHNlc3Npb25fbnVtYmVycykKICAgICAgICBzZWxmLnJlc3VsdF9sYWJlbC5jb25maWcodGV4dD1mIkjDo3kgxJHhurd0OiB7cmVzdWx0fSIpCiAgICAgICAgaWYgcmVzdWx0ID09ICJUw6BpIjoKICAgICAgICAgICAgc2VsZi5ibGlua19saWdodHMoc2VsZi50YWlfY2FudmFzKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYuYmxpbmtfbGlnaHRzKHNlbGYueGl1X2NhbnZhcykKCiAgICBkZWYgcHJlZGljdF9vdXRjb21lKHNlbGYsIHNlc3Npb25fbnVtYmVycyk6CiAgICAgICAgcmV0dXJuICJY4buJdSIgaWYgcmFuZG9tLnJhbmRvbSgpIDwgMC41IGVsc2UgIlTDoGkiCgogICAgZGVmIGJsaW5rX2xpZ2h0cyhzZWxmLCBsaWdodCk6CiAgICAgICAgIyBC4bqvdCDEkeG6p3UgbmjhuqVwIG5ow6F5IMSRw6huCiAgICAgICAgc2VsZi5ibGlua2luZyA9IFRydWUKICAgICAgICBpZiBzZWxmLmJsaW5rX3RocmVhZCBpcyBOb25lIG9yIG5vdCBzZWxmLmJsaW5rX3RocmVhZC5pc19hbGl2ZSgpOgogICAgICAgICAgICBzZWxmLmJsaW5rX3RocmVhZCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXNlbGYuYmxpbmssIGFyZ3M9KGxpZ2h0LCkpCiAgICAgICAgICAgIHNlbGYuYmxpbmtfdGhyZWFkLnN0YXJ0KCkKICAgICAgICAjIFThuqFvIG3hu5l0IGx14buTbmcgxJHhu4MgxJHhur9tIDI1IGdpw6J5IHbDoCB04bqvdCBuaOG6pXAgbmjDoXkKICAgICAgICB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zZWxmLnR1cm5fb2ZmX2FmdGVyXzI1X3NlY29uZHMpLnN0YXJ0KCkKCiAgICBkZWYgYmxpbmsoc2VsZiwgbGlnaHQpOgogICAgICAgIHdoaWxlIHNlbGYuYmxpbmtpbmc6CiAgICAgICAgICAgIGxpZ2h0Lml0ZW1jb25maWcoInhpdV9saWdodCIsIGZpbGw9InJlZCIpIGlmIGxpZ2h0ID09IHNlbGYueGl1X2NhbnZhcyBlbHNlIGxpZ2h0Lml0ZW1jb25maWcoInRhaV9saWdodCIsIGZpbGw9InJlZCIpCiAgICAgICAgICAgIHNlbGYubWFzdGVyLmFmdGVyKDIwMCwgbGFtYmRhOmxpZ2h0Lml0ZW1jb25maWcoInhpdV9saWdodCIsIGZpbGw9IiNjZDZhNWEiKSBpZiBsaWdodCA9PSBzZWxmLnhpdV9jYW52YXMgZWxzZSBsaWdodC5pdGVtY29uZmlnKCJ0YWlfbGlnaHQiLCBmaWxsPSIjY2Q2YTVhIikpCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4yKSAgIyBHaeG6o20gdGjhu51pIGdpYW4gY2jhu50geHXhu5FuZyAwLjIgZ2nDonkKCiAgICBkZWYgdHVybl9vZmZfYWZ0ZXJfMjVfc2Vjb25kcyhzZWxmKToKICAgICAgICB0aW1lLnNsZWVwKDI1KQogICAgICAgIHNlbGYuYmxpbmtpbmcgPSBGYWxzZQogICAgICAgIHNlbGYubWFzdGVyLmFmdGVyKDAsIGxhbWJkYTogc2VsZi54aXVfY2FudmFzLml0ZW1jb25maWcoInhpdV9saWdodCIsIGZpbGw9IiNjZDZhNWEiKSBhbmQgc2VsZi50YWlfY2FudmFzLml0ZW1jb25maWcoInRhaV9saWdodCIsIGZpbGw9IiNjZDZhNWEiKSkKCiAgICBkZWYgbG9hZF9pbWFnZV9mcm9tX3VybChzZWxmLCB1cmwsIGxhYmVsKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCkKICAgICAgICAgICAgaW1hZ2VfZGF0YSA9IHJlc3BvbnNlLmNvbnRlbnQKICAgICAgICAgICAgaW1hZ2UgPSBJbWFnZS5vcGVuKEJ5dGVzSU8oaW1hZ2VfZGF0YSkpCiAgICAgICAgICAgIHJlc2l6ZWRfaW1hZ2UgPSBpbWFnZS5yZXNpemUoKDUwLCA1MCksIEltYWdlLkxBTkNaT1MpICAjIFJlc2l6ZSBpbWFnZSB0byBmaXQgY2FudmFzCiAgICAgICAgICAgIHBob3RvID0gSW1hZ2VUay5QaG90b0ltYWdlKHJlc2l6ZWRfaW1hZ2UpCiAgICAgICAgICAgIGxhYmVsLmNvbmZpZyhpbWFnZT1waG90bykKICAgICAgICAgICAgbGFiZWwuaW1hZ2UgPSBwaG90byAgIyBLZWVwIGEgcmVmZXJlbmNlIHRvIGF2b2lkIGdhcmJhZ2UgY29sbGVjdGlvbgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJFcnJvciBsb2FkaW5nIGltYWdlOiB7ZX0iKQoKcm9vdCA9IHRrLlRrKCkKYXBwID0gVGFpWGl1QXBwKHJvb3QpCnJvb3QubWFpbmxvb3AoKQ=='))
